var t=require("@web3-react/abstract-connector"),e=require("@web3-react/types");function n(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,e}function r(t,e){return r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}function o(t,e){if(null==t)return{};var n,r,o={},u=Object.keys(t);for(r=0;r<u.length;r++)e.indexOf(n=u[r])>=0||(o[n]=t[n]);return o}var u=["activate","onError","throwErrors"],i=["supportedChainIds","connectors","uauth","shouldLoginWithRedirect"];if("undefined"!=typeof window){var c=window;c.UAUTH_VERSION=c.UAUTH_VERSION||{},c.UAUTH_VERSION.WEB3_REACT="2.4.0"}var a=/*#__PURE__*/function(t){var c,a;function s(e){var n;return(n=t.call(this,{supportedChainIds:e.supportedChainIds})||this).options=void 0,n._subConnector=void 0,n._uauth=void 0,n.handleUpdate=function(t){return n.emitUpdate(t)},n.handleDeactivate=function(){return n.emitDeactivate()},n.handleError=function(t){return n.emitError(t)},n.options=e,n}a=t,(c=s).prototype=Object.create(a.prototype),c.prototype.constructor=c,r(c,a),s.registerUAuth=function(t){s.UAuth=t},s.importUAuth=function(){try{var t=function(){if(null==s.UAuth)return Promise.resolve(Promise.resolve().then(function(){/*#__PURE__*/return n(require("@uauth/js"))}).then(function(t){var e;return null!=(e=null==t?void 0:t.default)?e:t})).then(function(t){s.UAuth=t})}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(t){return Promise.reject(t)}};var h,l,f=s.prototype;return f.callbackAndActivate=function(t){try{var e=this;return Promise.resolve(s.importUAuth()).then(function(){function n(){return r(e,i,c)}var r=t.activate,i=t.onError,c=t.throwErrors,a=o(t,u),s=a.url?Promise.resolve(e.uauth.loginCallback(a)).then(function(){}):Promise.resolve(e.uauth.loginCallback()).then(function(){});return s&&s.then?s.then(n):n()})}catch(t){return Promise.reject(t)}},f.activate=function(){try{var t=this;return Promise.resolve(s.importUAuth()).then(function(){var n;function r(r){var o;if(null==n.wallet_type_hint)throw new Error("no wallet type present");if(["web3","injected"].includes(n.wallet_type_hint))t._subConnector=t.options.connectors.injected;else{if("walletconnect"!==n.wallet_type_hint)throw new Error("Connector not supported");t._subConnector=t.options.connectors.walletconnect}return null!=t&&null!=(o=t._subConnector)&&o.on&&(t._subConnector.on(e.ConnectorEvent.Update,t.handleUpdate),t._subConnector.on(e.ConnectorEvent.Deactivate,t.handleDeactivate),t._subConnector.on(e.ConnectorEvent.Error,t.handleError)),Promise.resolve(t._subConnector.activate())}var o=function(e,r){try{var o=Promise.resolve(t.uauth.user()).then(function(t){n=t})}catch(t){return r()}return o&&o.then?o.then(void 0,r):o}(0,function(){if(!t.uauth.fallbackLoginOptions.scope.includes("wallet"))throw new Error('Must request the "wallet" scope for connector to work.');return t.options.shouldLoginWithRedirect?Promise.resolve(t.uauth.login({packageName:"@uauth/web3-react",packageVersion:"2.4.0"})).then(function(){return Promise.resolve(new Promise(function(){})).then(function(){throw new Error("Should never get here.")})}):Promise.resolve(t.uauth.loginWithPopup({packageName:"@uauth/web3-react",packageVersion:"2.4.0"})).then(function(){return Promise.resolve(t.uauth.user()).then(function(t){n=t})})});return o&&o.then?o.then(r):r()})}catch(t){return Promise.reject(t)}},f.deactivate=function(){var t;this._subConnector&&(this.uauth.fallbackLogoutOptions.rpInitiatedLogout||this.uauth.logout({rpInitiatedLogout:!1}),null!=this&&null!=(t=this._subConnector)&&t.removeListener&&(this._subConnector.removeListener(e.ConnectorEvent.Update,this.handleUpdate),this._subConnector.removeListener(e.ConnectorEvent.Deactivate,this.handleDeactivate),this._subConnector.removeListener(e.ConnectorEvent.Error,this.handleError)),this.uauth.logout(),this._subConnector.deactivate())},f.isAuthorized=function(){try{var t=this;return Promise.resolve(t.uauth.user()).then(function(e){var n;return!(!e||"function"!=typeof(null==(n=t.subConnector)?void 0:n.isAuthorized))&&t.subConnector.isAuthorized()})}catch(t){return Promise.reject(t)}},f.getProvider=function(){return this.subConnector.getProvider()},f.getChainId=function(){return this.subConnector.getChainId()},f.getAccount=function(){return this.subConnector.getAccount()},h=s,(l=[{key:"uauth",get:function(){var t=this.options,e=t.uauth,n=o(t,i);if(e)return e;if(this._uauth)return this._uauth;if(null==s.UAuth)throw new Error("Must import UAuth before constructing a UAuth Object");if(!n.clientID||!n.redirectUri)throw new Error("Incomplete constructor options");return this._uauth=new s.UAuth(n),this._uauth}},{key:"subConnector",get:function(){if(null==this._subConnector)throw new Error("no subconnector");return this._subConnector}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(h.prototype,l),Object.defineProperty(h,"prototype",{writable:!1}),s}(t.AbstractConnector);a.UAuth=void 0,exports.UAuthConnector=a;
//# sourceMappingURL=index.cjs.map
